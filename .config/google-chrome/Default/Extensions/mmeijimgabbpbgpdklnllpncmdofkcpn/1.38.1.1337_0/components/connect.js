!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=214)}({133:function(e,t,n){"use strict";angular.module("castifyExt.connect.connectService",["castifyExt.simpleBgServiceConsumer"]).factory("connectService",["simpleBgServiceConsumer",function(e){return e("connect",["share"])}])},136:function(e,t,n){"use strict";angular.module("castifyExt.fileDbClient",["castifyExt.backgroundTool","castifyExt.appOptions","castifyExt.castifyAuth"]).factory("fileDbClient",["backgroundTool","$q","appOptions","castifyAuth","$log",function(e,t,n,r,o){var i=e.portHelper("files",!1),a={},c={},u=null,s=!1,l={},f=0;function d(){return u||(u=t.defer(),i.postMessage("subscribe")),u.promise}function p(e){angular.extend(this,e),this.createdAt&&(this.createdAt=new Date(this.createdAt))}function g(e){var t=a[e];t&&(t.deleted=!0,delete a[e])}function h(e,t){var n;t&&(n={},angular.forEach(a,function(e,t){n[t]=!0})),angular.forEach(e,function(e,r){!function(e){var t=a[e.id];t?angular.copy(e,t):a[e.id]=e}(new p(e)),t&&delete n[r]}),t&&angular.forEach(n,function(e,t){g(t)})}p.prototype.getUrl=function(e=!1){var n=this;const o=e&&!!n.driveInfo&&!!n.driveInfo.downloadUrl;return n.urlRequiresAccessToken||o?r.getAuthToken({interactive:!1}).then(function(e){var t=o?n.driveInfo.downloadUrl:n.url;return t.indexOf("?")>=0?t+="&":t+="?",t+"access_token="+e}):t.when(n.url)};var m={filesUpdate:function(e){e.remove&&e.remove.forEach(g),e.add&&h(e.add,!1),e.full?(h(e.full,!0),!s&&u&&(s=!0,u.resolve())):e.error&&(s=!1,u&&(u.reject(),u=null)),f++},reloadSuccess:function(e){l[e]&&(l[e].resolve(),delete l[e])},reloadError:function(e){l[e]&&(l[e].reject(),delete l[e])}};return i.installHandlers(m),c.getFileDescriptor=function(e){return d().then(function(){var n=a[e];return n||t.reject()})},c.listFiles=function(){return d().then(function(){return a})},c.rename=function(e,t){var n=a[e];n&&(n.title=t),i.postMessage("rename",{id:e,title:t})},c.reload=function(e){return l[e]||(l[e]=t.defer(),i.postMessage("reload",e)),l[e].promise},c.remove=function(e){o.debug("fileDbClient.remove",e),g(e),i.postMessage("remove",e)},c.removeAll=function(e){o.debug("fileDbClient.removeAll"),angular.copy({},a),i.postMessage("removeAll",e)},c.isSyncEnabled=function(){return n.values.driveSync},c.getListVersionId=function(){return f},c}])},148:function(e,t,n){"use strict";angular.module("w69b.asyncResponse",[]).factory("asyncResponse",["$q",function(e){var t={createSender:function(t){var n={},r=0,o={};return n.sendWithResponse=function(n,i){var a=++r,c=e.defer();return o[a]=c,t({type:n,data:i,msgId:a}),c.promise},n.send=function(e,n){t({type:e,data:n})},n.handleResult=function(e){if(e&&"result"===e.type){var t=o[e.msgId];return delete o[e.msgId],e.hasOwnProperty("error")||e.isError?t.reject(e.error):t.resolve(e.data),!0}return!1},n},createRespond:function(t){return function(n,r){e.when(n).then(function(e){t({type:"result",msgId:r.msgId,data:e})},function(e){t({type:"result",msgId:r.msgId,error:e,isError:!0})})}}};return t}])},149:function(e,t,n){"use strict";angular.module("castifyExt.oauthTokenCache",["w69b.chromeStorage"]).factory("oauthTokenCache",["chromeStorage","$q",function(e,t){return function(n){var r=0,o={};function i(){return e.local.getSingle(n).then(function(e){return e||{}})}function a(){return Math.floor(Date.now()-r)+12e4}return o.get=function(e){return i().then(function(n){var r=n[e];return r&&r.expiresAt>a()?t.when(r):t.reject()})},o.put=function(t,o){return i().then(function(i){return i[t]=o,o.issuedAt&&(r=Date.now()-Number(o.issuedAt)),function(e){var t=a();angular.forEach(e,function(n,r){(!r.expiresAt||r.expiresAt<=t)&&delete e[n]})}(i),e.local.setSingle(n,i)})},o.removeByToken=function(t){return i().then(function(r){return angular.forEach(r,function(e,n){e.accessToken===t&&delete r[n]}),e.local.setSingle(n,r)})},o.remove=function(t){return i().then(function(r){return delete r[t],e.local.setSingle(n,r)})},o.clear=function(){return e.local.remove(n)},o.withCache=function(e,t){return o.get(e).catch(function(){return t().then(function(t){return o.put(e,t).then(function(){return t})})})},o}}])},150:function(e,t,n){"use strict";angular.module("castifyExt.localFileDb",["w69b.chromeStorage","w69b.filesHelper"]).factory("localFileDb",["$filter","$q","chromeStorage","filesHelper",function(e,t,n,r){var o={},i=n.local,a="filedb_";function c(e){return a+e}function u(e){var t=c(e);return i.getSingle(t,{})}function s(e){angular.extend(this,e)}var l=s.prototype;return s.createFromIdOrFileEntry=function(e){var n,i;return(angular.isString(e)?r.getFileEntryByPath(o.idToFilename(e)):t.when(e)).then(function(e){return n=e,i=o.filenameToId(e.name),t.all({metadata:r.getMetadata(n),info:u(i)}).then(function(e){var t=n.toURL(),r={id:i,uuid:i,url:t,mimeType:"video/webm",createdAt:e.metadata.modificationTime,title:e.info.title,size:e.metadata.size};if(e.info.videoInfo){var o=e.info.videoInfo;angular.extend(r,{duration:o.duration,width:o.size.width,height:o.size.height})}if(e.info.previewImages&&(r.thumbnailUrl=e.info.previewImages[0].url),e.info.driveInfo&&(r.driveInfo=e.info.driveInfo),e.info.youtubeInfo){var a=e.info.youtubeInfo;r.youtubeInfo={id:a.id,channelId:a.channelId}}return e.info.autoShare&&(r.autoShare=e.info.autoShare),new s(r)})})},l.rename=function(e){return o.updateInfo(this.id,{title:e})},l.remove=function(){var e=this.id;return t.all({result:r.removeByPath(o.idToFilename(e)),info:u(e)}).then(function(e){if(e.info.previewImages)return t.all(e.info.previewImages.map(function(e){return r.removeByPath(e.path)}))}).then(function(){return i.remove(c(e))})},l.updateYoutubeInfo=function(e){return o.updateInfo(this.id,{youtubeInfo:e})},o.listFiles=function(){return r.listByPath("/").then(function(e){var n=[];return e.forEach(function(e){e.isFile&&"."!==e.name[0]&&n.push(s.createFromIdOrFileEntry(e))}),t.all(n).then(function(e){var t={};return e.forEach(function(e){t[e.id]=e}),t})})},o.filenameToId=function(e){if(/\.webm/i.test(e))return e.slice(0,-5);throw new Error("invalid filename: "+e)},o.idToFilename=function(e){return e+".webm"},o.getFileDescriptor=function(e){return s.createFromIdOrFileEntry(e)},o.updateInfo=function(e,n,r){var o=c(e);return(r?t.when(n):i.get(o).then(function(e){return angular.extend(e[o]||{},n)})).then(function(e){var t={};return t[o]=e,i.set(t),e})},o}])},214:function(e,t,n){"use strict";n.r(t);n(25),n(44),n(38),n(60),n(61),n(26),n(64),n(27),n(65),n(63),n(62),n(148),n(215),n(49),n(216),n(48),n(47),n(89),n(133),n(55),n(56),n(51),n(53),n(52),n(45),n(149),n(54),n(50),n(57),n(46),n(136),n(150);angular.module("castifyExt.ConnectApp",["castifyExt.commonConfig","castifyExt.connect.connectFrame"]).run(["connectFrame",function(e){e.install()}])},215:function(e,t,n){"use strict";angular.module("w69b.originWildcardMatcher",[]).factory("originWildcardMatcher",function(){return function(e){return function(t){if(t===e)return!0;if(t.indexOf("*")>-1){var n=e.split("://"),r=t.split("://");if(n=[n[0]].concat(n[1].split(".")),(r=[r[0]].concat(r[1].split("."))).length!==n.length)return!1;for(var o=0;o<n.length;++o)if(n[o]!==r[o]&&"*"!==r[o])return!1;return!0}return!1}}})},216:function(e,t,n){"use strict";angular.module("castifyExt.connect.connectFrame",["castifyExt.fileDbClient","w69b.filesHelper","w69b.asyncResponse","w69b.chromeRuntime","w69b.promiseTool","w69b.originWildcardMatcher","castifyExt.connect.connectedApps","castifyExt.connect.appRegistry","castifyExt.connect.appPermissions"]).factory("connectFrame",["$location","filesHelper","$window","connectedApps","appPermissions","$q","spawn","appRegistry","asyncResponse","chromeRuntime","promiseTool","fileDbClient","originWildcardMatcher",function(e,t,n,r,o,i,a,c,u,s,l,f,d){var p,g,h,m={},y=u.createSender(function(e){n.parent.postMessage(e,g)});var v={};function b(e,t){var r=t.data.msgId;i.when(e).then(function(e){n.parent.postMessage({type:"result",data:e,msgId:r},t.origin)},function(e){e instanceof Error&&(e=e.message),n.parent.postMessage({type:"result",error:e,msgId:r},t.origin)})}function w(e){var t=e.data;if(t)if("setAppId"===t.type)b(v.setAppId(t.data,e),e);else{var n=function(e){return g?g!==e.origin?i.reject("Origin not allowed: "+e.origin):i.when():i.reject("call setAppId() first")}(e);t&&"result"===t.type?n.then(function(){y.handleResult(t)}):(n=n.then(function(){return v.hasOwnProperty(t.type)?v[t.type](t.data,e):t.msgId?h.sendWithResponse(t.type,t.data):h.send(t.type,t.data)}),t.msgId&&b(n,e))}}return v.getFile=function(e){return a(function*(){return(yield o.hasAccess(p.id,e))?function(e){return a(function*(){var n=yield f.getFileDescriptor(e),r=yield t.getFileByPath(e+".webm");return r=new Blob([r],{type:"video/webm"}),{id:n.id,width:n.width,height:n.height,duration:n.duration,title:n.title,file:r,inLibrary:!n.autoShare,payload:n.autoShare&&n.autoShare.payload}})}(e):i.reject("access_denied")})},v.isAppConnected=function(){return r.isConnected(p.id)},v.setUserExpiryDate=function(e){return p.isPaidInstall?null===e||angular.isNumber(e)?r.setUserExpiryDate(p.id,e):i.reject("date has to be null or a Number"):i.reject("only available for paid Apps")},v.setUserShareUrl=function(e){return null===e||angular.isString(e)&&/https?:\/\//.test(e)?r.setUserShareUrl(p.id,e):i.reject("url has to be null or a URL string")},v.setAppId=function(e,t){return p?i.reject("appId already set"):c.getAppInfo(e).then(function(n){return n?n.allowedOrigins.some(d(t.origin))?(g=t.origin,p=n,r=s.connect({name:"connectFrame"}),o=u.createRespond(r.postMessage.bind(r)),(h=u.createSender(r.postMessage.bind(r))).send("connect",p),void r.onMessage.addListener(function(e){if(!h.handleResult(e))if(e.msgId){var t=y.sendWithResponse(e.type,e.data);o(t,e)}else y.send(e.type,e.data)})):i.reject("Origin not allowed for this App: "+t.origin):i.reject("unknown appId "+e);var r,o},function(){return i.reject("failed to load app config")})},v.startRecording=function(e){if(document.hidden)return i.reject("tab must be visible to start recording");if(e&&e.payload){if(!angular.isString(e.payload))return i.reject("payload must be a string");if(e.payload.length>1024)return i.reject("payload is too long")}return h.sendWithResponse("startRecording",e)},m.install=function(){var e,t;n.addEventListener("message",w),e="ready",n.parent.postMessage({type:e,data:t},"*")},m}])},25:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};angular.module("castifyExt.deployConfig",[]).provider("deployConfig",function(){let e=r({apiUrl:"https://api.screencastify.com/api",clientId:"242262968495-o42n5tqeo08dsa75p3j4dk1k61t05ln3.apps.googleusercontent.com",scopes:chrome.runtime.getManifest().oauth2.scopes,redirectUri:"https://www.screencastify.com/oauth2postback",editorOpenUri:"https://editor.screencastify.com/open/drive",notificationUri:"https://us-central1-castify-notifications-prod.cloudfunctions.net/api/userNotification/",uploadServiceURL:"https://ingress.screencastify.com/api/uploadService",exportServiceURL:"https://ingress.screencastify.com/api/exportService",firebase:{apiKey:"AIzaSyDraAcnfh7TewzYJS9yt8Togm6_VzB_RJE",authDomain:"castify-storage.firebaseapp.com",databaseURL:"wss://castify-storage.firebaseio.com",projectId:"castify-storage",storageBucket:"castify-storage.appspot.com",messagingSenderId:"37637381719"}},{enableInlinePopupSupport:!1});return r({},e,{$get:function(){return e}})})},26:function(e,t,n){"use strict";angular.module("w69b.promiseTool",[]).factory("promiseTool",["$q","$timeout",function(e,t){var n={wrapChromeError:function(t,n){return function(){var r=Array.prototype.slice.call(arguments,0),o=e.defer();return r.push(function(e){chrome.runtime.lastError?o.reject(chrome.runtime.lastError):o.resolve(e)}),t.apply(n,r),o.promise}},wrapCallbacks:function(t,n){return function(){var r=Array.prototype.slice.call(arguments,0),o=e.defer();return r.push(o.resolve.bind(o)),r.push(o.reject.bind(o)),t.apply(n,r),o.promise}},serializer:function(){var t=null,n=function(n){var r=e.defer();return(t||e.when()).then(function(){(n.call()||e.when()).then(e=>r.resolve(e),e=>r.reject(e))}),(t=r.promise.catch(()=>null)).then(function(){t=null}),r.promise};return n.wrap=function(e){return function(){return n(e.bind(this,...arguments))}},n},withTimeout:function(n,r,o){o||(o=angular.noop);var i=e.defer(),a=t(function(){var e=o();angular.isDefined(e)?i.resolve(e):i.reject("timeout"),i=null},r);function c(){t.cancel(a),a=null}return n().then(function(){c(),i&&i.resolve.apply(i,arguments)},function(){c(),i&&i.reject.apply(i,arguments)}),i.promise}};return n}])},27:function(e,t,n){"use strict";angular.module("w69b.spawn",[]).factory("spawn",["$q",function(e){function t(t,n){var r=n?Promise.reject.bind(Promise):e.reject.bind(e),o=n?Promise.resolve.bind(Promise):e.when.bind(e);function i(e,t){var n;try{n=e(t)}catch(e){return r(e)}return n.done?o(n.value):o(n.value).then(c,u)}var a=t(),c=i.bind(null,a.next.bind(a)),u=i.bind(null,a.throw.bind(a));return c()}return t.wrap=function(e){return function(){var n=arguments;return t(e.bind(this,...n))}},t}])},38:function(e,t,n){"use strict";angular.module("w69b.chromeRuntime",["w69b.promiseTool"]).factory("chromeRuntime",["promiseTool",function(e){var t={};return t.sendMessage=e.wrapChromeError(chrome.runtime.sendMessage,chrome.runtime),t.getBackgroundPage=e.wrapChromeError(chrome.runtime.getBackgroundPage,chrome.runtime),t.connect=chrome.runtime.connect.bind(chrome.runtime),t.getManifest=chrome.runtime.getManifest.bind(chrome.runtime),t.id=chrome.runtime.id,chrome.runtime.getPlatformInfo&&(t.getPlatformInfo=e.wrapChromeError(chrome.runtime.getPlatformInfo,chrome.runtime)),t.setUninstallURL=e.wrapChromeError(chrome.runtime.setUninstallURL,chrome.runtime),["onMessage","onMessageExternal","onConnect","onConnectExternal","onInstalled","onSuspend"].forEach(function(e){t[e]={addListener:function(t){chrome.runtime[e].addListener(t)},removeListener:function(t){chrome.runtime[e].removeListener(t)}}}),t}])},44:function(e,t,n){"use strict";window.angular&&angular.module("w69b.es6",[]),Array.prototype.find||(Array.prototype.find=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;i<r;i++)if(t=n[i],e.call(o,t,i,n))return t}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==this)throw new TypeError("Cannot convert this value to object");var t=Object(this),n=parseInt(t.length,10)||0;if(0===n)return!1;var r,o=parseInt(arguments[1],10)||0;if(o>=n)return!1;for(o>=0?r=o:(r=n+o)<0&&(r=0);r<n;){var i=t[r];if(e===i||e!=e&&i!=i)return!0;r++}return!1}}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(e,t){return t=t||0,this.lastIndexOf(e,t)===t}})},45:function(e,t,n){"use strict";
/*!
 * Copyright 2018 Screencastify LLC
 */function r(e,t,n,r){var o={videoTitleNamingScheme:"tabTitle",notifyAudio:!0,notifyFramerate:!1,notifyTabFocus:!0,uploadPrivacy:"public",autoOpen:!0,autoPlay:!0,driveSync:!1,enableDiskSpaceWatcher:!0,notifySyncProgress:!1,notifyEditProgress:!0,enableAnalytics:!0,showEditToolsHint:!0,enableWindowPicker:!0,encoder:null,audioCodec:null,bitRateOption:"high",hwEncoding:!1,hideRestartAlert:!1,instantUpload:!1,featureRolloutRand:null,hasUsedAudioExport:!1,enableEditorTrial:!1,enableInlinePopupUi:!1,enablePiP:!1,enableAudioExport:!1},i=!1,a={},c={},u={};function s(e){return r.options.hasOwnProperty(e)}return a.localValues=angular.copy({micGain:1,micAudioProcessing:!0}),a.loadedPromise=n.all({sync:e.sync.getSingle("options"),local:e.local.getSingle("options"),rollout:e.sync.getSingle("rolloutOptions"),managed:r.loadedPromise}).then(function(e){angular.extend(c,e.sync),angular.extend(u,e.rollout),angular.extend(a.localValues,e.local),i=!0}),a.values={},Object.keys(o).forEach(function(e){Object.defineProperty(a.values,e,{enumerable:!0,get:function(){return s(e)?function(e){return r.options[e]}(e):c.hasOwnProperty(e)?c[e]:u.hasOwnProperty(e)?u[e]:o[e]},set:function(t){c[e]=t}})}),a.setRolloutValues=function(t){return u=t,e.sync.setSingle("rolloutOptions",u)},a.save=function(){return e.sync.setSingle("options",c)},a.saveLocal=function(){return e.local.setSingle("options",a.localValues)},a.isLoaded=function(){return i},a.isSetByEnterprisePolicy=function(e){return s(e)},e.onChanged.addListener(function(e,n){"sync"===n&&e.options&&(angular.extend(c,e.options.newValue),t.$$phase||t.$digest()),"sync"===n&&e.rolloutOptions&&(angular.extend(u,e.rolloutOptions.newValue),t.$$phase||t.$digest()),"local"===n&&e.options&&(angular.extend(a.localValues,e.options.newValue),t.$$phase||t.$digest())}),a}r.$inject=["chromeStorage","$rootScope","$q","enterprisePolicy"],angular.module("castifyExt.appOptions",["w69b.chromeStorage","castifyExt.enterprisePolicy"]).factory("appOptions",r)},46:function(e,t,n){"use strict";angular.module("castifyExt.backgroundTool",["w69b.chromeRuntime"]).factory("backgroundTool",["chromeRuntime","$q","$rootScope",function(e,t,n){var r;function o(){var n=t.defer();return e.onMessage.addListener(function t(r){"bg:loaded"===r&&(e.onMessage.removeListener(t),n.resolve())}),e.sendMessage("bg:load").catch(angular.identity),n.promise}var i={portHelper:function(r,i){var a,c={getPort:function(){return(!1===i?t.when():o()).then(function(){return a||(a=e.connect({name:r})),a})},postMessage:function(e,t){return c.getPort().then(function(n){return n.postMessage({type:e,data:t})})},installHandlers:function(e){function t(t){e.hasOwnProperty(t.type)&&e[t.type](t.data),n.$$phase||n.$apply()}return c.getPort().then(function(e){e.onMessage.addListener(t)}),function(){c.getPort().then(function(e){e.onMessage.removeListener(t)})}}};return c},loadBackground:function(){return r||(r=o()),r}};return i}])},47:function(e,t,n){"use strict";angular.module("castifyExt.connect.appRegistry",["w69b.spawn","w69b.chromeStorage"]).factory("appRegistry",["castifyConfig","$http","$q","spawn","chromeStorage",function(e,t,n,r,o){var i=e.API_URL+"/apps",a={},c="appRegistry:cache",u=6e4;function s(){return o.local.getSingle(c,[])}function l(e){return e.forEach(function(e){delete e._fetchTimestamp}),e}function f(e,t){return r(function*(){e=new Set(e||[]);var n,r=yield s();t.forEach(function(t){e.add(t.id)}),r=r.filter(function(t){return!e.has(t.id)}),t.forEach(function(e){e._fetchTimestamp=Date.now()}),r=r.concat(t),yield(n=r,o.local.setSingle(c,n))})}function d(e){return r(function*(){if(!e||0===e.length)return n.when([]);var r,o=yield function(e){return s().then(function(t){return t.filter(function(t){return e.includes(t.id)})})}(e);if(function(e,t){var n=Date.now();return!e.some(function(e){return n>e._fetchTimestamp+u})&&t.length===e.length}(o,e))return l(o);try{r=(yield t.get(i,{params:{ids:e}})).data}catch(e){return l(o)}return yield f(e,r),l(r)})}return a.getApps=function(e){return d(e)},a.getAppInfo=function(e){return d([e]).then(function(e){return e.length?e[0]:n.reject()})},a}])},48:function(e,t,n){"use strict";angular.module("castifyExt.connect.connectedApps",["w69b.chromeStorage","w69b.spawn","castifyExt.connect.appRegistry"]).factory("connectedApps",["chromeStorage","spawn","appRegistry","$rootScope",function(e,t,n,r){var o={},i="connectedAppIds",a="connectedAppRecentId";function c(){return e.sync.getSingle(i,[]).then(function(e){return e.map(function(e){return angular.isObject(e)?e:{id:e,hasShareUrl:!0}})})}function u(t){return e.sync.setSingle(i,t)}function s(t){return e.sync.setSingle(a,t)}function l(e,t){return e.some(function(e){return e.id===t})}o.getConnected=function(e){return t(function*(){var t=yield c();return e&&(t=t.filter(function(t){var n=!0;return angular.forEach(e,function(e,r){n=n&&t[r]===e}),n})),t.map(function(e){return e.id})})},o.getConnectedAppInfo=t.wrap(function*(){var e=yield c(),t=yield n.getApps(e.map(e=>e.id));return(t=angular.copy(t)).forEach(function(t){var n=e.find(e=>e.id===t.id);angular.extend(t,n)}),t}),o.getConnectedAppInfoForApp=t.wrap(function*(e){var t=(yield o.getConnectedAppInfo()).find(t=>t.id===e);return t||null}),o.hasConnectedApps=function(){return o.getConnected().then(e=>e.length>0)},o.isConnected=function(e){return t(function*(){return l(yield c(),e)})},o.disconnect=function(e){return t(function*(){var t=yield c();t=t.filter(function(t){return t.id!==e}),yield s(null),yield u(t),r.$broadcast("connect:appDisconnected",e)})},o.connect=function(e){return t(function*(){var t=yield c(),o=yield n.getAppInfo(e);l(t,e)||(t.push({id:e,hasShareUrl:!!o.shareUrl}),o.shareUrl&&(yield s(e))),yield u(t),r.$broadcast("connect:appConnected",e,o)})};var f=t.wrap(function*(e,t,n){var r=yield c(),o=r.find(t=>t.id===e);if(!o)throw new Error("Cannot set user data for non-connected app");var i=o[t];return null===n||angular.isUndefined(n)?delete o[t]:o[t]=n,yield u(r),i});return o.setUserExpiryDate=t.wrap(function*(e,t){var n=yield f(e,"userExpiryDate",t);r.$broadcast("connect:userExpiryDateChange",n,t)}),o.setUserShareUrl=function(e,t){return f(e,"shareUrl",t)},o.clearRecent=function(){return s(null)},o.getRecent=function(){return e.sync.getSingle(a)},o}])},49:function(e,t,n){"use strict";angular.module("castifyExt.chromeEventPublisher",[]).run(["chromeRuntime","$rootScope",function(e,t){e.onMessage.addListener(function(e){angular.isObject(e)&&angular.isString(e.type)&&0===e.type.lastIndexOf("event:",0)&&t.$broadcast(e.type,e.data),t.$$phase||t.$digest()})}])},50:function(e,t,n){"use strict";angular.module("castifyExt.castifyAuth",["castifyExt.simpleBgServiceConsumer"]).factory("castifyAuth",["simpleBgServiceConsumer",function(e){return e("castifyAuth",["launchWebAuthFlow","getRedirectURL","removeCachedAuthToken","getAuthToken","getAccount"])}]).factory("googleauth",["castifyAuth","$q",function(e,t){var n={loadClient:function(){return t.when()},getAuthToken:function(t){e.getAuthToken(angular.isObject(t)?t:{interactive:!!t})}};return n}])},51:function(e,t,n){"use strict";angular.module("castifyExt.commonConfig",["castifyExt.castifyAuth","w69b.chromeAnalytics","w69b.chromeRuntime","castifyExt.helpCenterConfig","castifyExt.appOptions","castifyExt.userAccount","castifyExt.deployConfig"]).config(["$compileProvider","$sceDelegateProvider","analyticsProvider","$locationProvider",function(e,t,n,r){n.setTrackingId("UA-23874345-14"),n.setApp("Screencastify"),t.resourceUrlWhitelist(["self","http://localhost:9008/**","blob:**","filesystem:chrome-extension://**","https://**"]);var o=/^\s*(https?|mailto|blob|chrome-extension|filesystem:chrome-extension):/;e.aHrefSanitizationWhitelist(o),e.imgSrcSanitizationWhitelist(o),r.hashPrefix("")}]).run(["$rootScope","analytics","chromeRuntime","appOptions","$injector","userAccount",function(e,t,n,r,o,i){var a=o.has("$transitions")?o.get("$transitions"):null,c=r.loadedPromise.then(u);function u(){return i.getAccount().then(function(e){var o="unknown";if(e.license.isPaid)o="paid";else{if(!e.license.isTester)return"trial";o="tester"}t.tracker.set("dimension1",o),t.tracker.set("dimension2",n.getManifest().version),t.tracker.set("dimension5",r.values.hwEncoding),e.user?(t.tracker.set("userId",e.user.analyticsUid),t.tracker.set("dimension4",e.user.analyticsUid),t.setEnabled(r.values.enableAnalytics&&!1!==e.user.analyticsEnabled)):t.setEnabled(r.values.enableAnalytics)})}a&&a.onSuccess({},function(e){var n=e.targetState().state(),r=n.analyticsView||n.pageTitle;r&&c.then(function(){t.tracker.sendAppView(r)})}),e.$on("event:userAccountChanged",u)}]).factory("castifyConfig",["deployConfig",e=>({API_URL:e.apiUrl,IS_E2E:window.localStorage.e2e})])},52:function(e,t,n){"use strict";angular.module("castifyExt.authConfig",["castifyExt.youtubeAuth","castifyExt.castifyAuth","w69b.chromeRuntime","w69b.googleHttpAuthInterceptor","castifyExt.youtubeAuth"]).config(["$httpProvider","youtubeAuthProvider","googleHttpAuthInterceptorProvider","deployConfigProvider",function(e,t,n,r){t.setClientId(r.clientId),e.interceptors.push("youtubeHttpAuthInterceptor"),e.interceptors.push("googleHttpAuthInterceptor"),n.enableAuthAutoRetry(!0),n.setAuthProvider("castifyAuth")}])},53:function(e,t,n){"use strict";angular.module("castifyExt.userAccount",["castifyExt.simpleBgServiceConsumer","castifyExt.chromeEventPublisher"]).factory("userAccount",["simpleBgServiceConsumer",function(e){return e("userAccount",["getAccount","signIn","postUpdate","signOut"])}])},54:function(e,t,n){"use strict";angular.module("castifyExt.enterprisePolicy",["w69b.chromeStorage"]).provider("enterprisePolicy",function(){var e={};this.setOverride=function(t){e=t},this.$get=["chromeStorage","$rootScope",function(t,n){var r={},o=!1,i={options:{}};angular.extend(i,e);var a=["disableSharing","disableSaveToDisk","options"];return a.forEach(function(e){Object.defineProperty(r,e,{get:function(){return i[e]}})}),r.loadedPromise=t.managed.get(a).then(function(t){angular.extend(i,t,e),o=!0}),r.isLoaded=function(){return o},r.has=function(e){return i.hasOwnProperty(e)},r.get=function(e){return i[e]},t.onChanged.addListener(function(e,t){"managed"===t&&(angular.forEach(e,function(e,t){i[t]=e.newValue}),n.$$phase||n.$digest())}),r}]})},55:function(e,t,n){"use strict";angular.module("castifyExt.helpCenter",["w69b.chromeTabs"]).factory("helpCenter",["chromeTabs",function(e){var t={tagUrls:{},registerUrl:function(e,n){t.tagUrls[e]=n},hasHelpFor:function(e){return t.tagUrls.hasOwnProperty(e)},openHelp:function(n){var r=t.tagUrls[n];if(!r)throw new Error("No help url registered for "+n);e.create({url:r})},setNotifyHelp:function(e,n){e.onButtonClicked=e.onClicked=function(){t.openHelp(n),e.clear()}}};return t}])},56:function(e,t,n){"use strict";angular.module("castifyExt.helpCenterConfig",["castifyExt.helpCenter"]).run(["helpCenter",function(e){e.registerUrl("load_nacl","https://screencastify.helpscoutdocs.com/article/33-failed-to-load-nacl-module"),e.registerUrl("disk_space","https://screencastify.helpscoutdocs.com/article/32-out-of-disk-space"),e.registerUrl("drive_apps","https://screencastify.helpscoutdocs.com/article/34-enabling-drive-on-google-apps"),e.registerUrl("start_recording","https://screencastify.helpscoutdocs.com/article/35-failed-to-start-recording"),e.registerUrl("change_account","https://screencastify.helpscoutdocs.com/article/31-how-to-sign-in-with-a-different-account"),e.registerUrl("quotaExceeded","https://screencastify.helpscoutdocs.com/article/20-out-of-space-on-google-drive"),e.registerUrl("youtubeSignupRequired","https://screencastify.helpscoutdocs.com/article/24-youtubesignuprequired-error-when-uploading-to-youtube"),e.registerUrl("no_audio","https://screencastify.helpscoutdocs.com/article/82-failed-to-capture-audio"),e.registerUrl("no_cam","https://screencastify.helpscoutdocs.com/article/83-failed-to-access-your-webcam"),e.registerUrl("no_audio_access","https://help.screencastify.com/article/213-screencastify-failed-to-capture-audio"),e.registerUrl("trial_monthly_limit","https://www.screencastify.com/buy?utm_source=app&utm_content=notify&utm_campaign=monthly_limit"),e.registerUrl("youtubeCredentialsMissing","https://help.screencastify.com/article/219-i-received-a-youtubeauth-failed-error")}])},57:function(e,t,n){"use strict";angular.module("castifyExt.simpleBgServiceConsumer",["w69b.chromeRuntime"]).factory("simpleBgServiceConsumer",["chromeRuntime","$q",function(e,t){return function(n,r){var o={};function i(e){return e.error?t.reject(e.error):e.data}return r.forEach(function(t){o[t]=function(t){return function(){return e.sendMessage({type:"simpleService",fn:t,service:n,data:Array.prototype.concat.apply([],arguments)}).then(i)}}(t)}),o}}])},60:function(e,t,n){"use strict";angular.module("w69b.chromeStorage",["w69b.promiseTool"]).factory("chromeStorage",["promiseTool",function(e){var t=chrome.storage,n={};return["local","sync","managed"].forEach(function(r){n[r]={},["set","get","remove","clear"].forEach(function(o){n[r][o]=e.wrapChromeError(t[r][o],t[r])}),n[r].setSingle=function(e,t){var o={};return o[e]=t,n[r].set(o)},n[r].getSingle=function(e,t){return n[r].get(e).then(function(n){return n.hasOwnProperty(e)?n[e]:t})}}),n.onChanged=t.onChanged,n}])},61:function(e,t,n){"use strict";angular.module("w69b.chromeTabs",["w69b.promiseTool"]).factory("chromeTabs",["$window","promiseTool","$q",function(e,t,n){if(!e.chrome||!e.chrome.tabs)return null;var r=e.chrome,o={};return o.query=t.wrapChromeError(r.tabs.query,r.tabs),o.getActiveTab=function(){return o.query({active:!0,windowId:r.windows.WINDOW_ID_CURRENT}).then(function(e){return e.length?e[0]:n.reject()})},o.get=t.wrapChromeError(r.tabs.get,r.tabs),o.update=t.wrapChromeError(r.tabs.update,r.tabs),o.remove=t.wrapChromeError(r.tabs.remove,r.tabs),o.create=t.wrapChromeError(r.tabs.create,r.tabs),o.connect=r.tabs.connect.bind(r.tabs),o.setZoomSettings=t.wrapChromeError(r.tabs.setZoomSettings,r.tabs),o.setZoom=t.wrapChromeError(r.tabs.setZoom,r.tabs),o.executeScript=t.wrapChromeError(r.tabs.executeScript,r.tabs),o.insertCSS=t.wrapChromeError(r.tabs.insertCSS,r.tabs),o.sendMessage=t.wrapChromeError(r.tabs.sendMessage,r.tabs),o.onUpdated=r.tabs.onUpdated,o.onActivated=r.tabs.onActivated,o.sendMessageActive=function(e,t){return o.getActiveTab().then(function(n){return o.sendMessage(n.id,e,t)})},o}]).directive("newTab",["chromeTabs",function(e){return{restrict:"A",link:function(t,n,r){n.bind("click",function(t){t.preventDefault(),e.create({url:r.href}).then(function(e){chrome.windows.update(e.windowId,{focused:!0},angular.noop)})})}}}])},62:function(e,t,n){"use strict";angular.module("w69b.filesHelper",["w69b.promiseTool"]).factory("filesHelper",["$window","promiseTool","$q",function(e,t,n){e.requestFileSystem=e.requestFileSystem||e.webkitRequestFileSystem;var r=window.PERSISTENT,o={};function i(e){var t=e.split("/");return[t.slice(0,-1).join("/"),t.slice(-1)[0]]}return["readEntries","remove","getFile","getMetadata","moveTo","file","getDirectory","createWriter"].forEach(function(e){o[e]=function(n){var r=[].slice.call(arguments,1);return t.wrapCallbacks(n[e],n).apply(null,r)}}),o.getFileSystem=function(n,o){return angular.isUndefined(n)&&(n=r),o=o||104857600,t.wrapCallbacks(e.requestFileSystem,e)(n,o)},o.getPersistentQuota=function(){var t=n.defer();return e.navigator.webkitPersistentStorage.queryUsageAndQuota(function(e,n){t.resolve({usage:e,quota:n})},function(e){t.reject(e)}),t.promise},chrome.system&&chrome.system.storage&&(o.getStorageInfo=t.wrapChromeError(chrome.system.storage.getInfo,chrome.system.storage)),o.getDirByPath=function(e,t){var r=e.split("/");return""===r[0]&&r.splice(0,1),o.getFileSystem().then(function(e){return function e(r,i){return i.length?o.getDirectory(r,i[0],t||{}).then(function(t){return e(t,i.slice(1))}):n.when(r)}(e.root,r)})},o.moveFileByPath=function(e,t){var r=i(t),a=r[0],c=r[1];return n.all({file:o.getFileEntryByPath(e),targetDir:o.getDirByPath(a)}).then(function(e){return o.moveTo(e.file,e.targetDir,c)})},o.getFileEntryByPath=function(e,t,n){var r=i(e),a=r[0],c=r[1];return o.getDirByPath(a,n).then(function(e){return o.getFile(e,c,t||{})})},o.getFileByPath=function(e){return o.getFileEntryByPath(e).then(function(e){return o.file(e)})},o.removeByPath=function(e){return o.getFileEntryByPath(e).then(function(e){return o.remove(e)})},o.listByPath=function(e){return o.getDirByPath(e).then(function(e){var t=e.createReader();return o.readEntries(t)})},o.requestPersistentQuota=function(e){return t.wrapCallbacks(navigator.webkitPersistentStorage.requestQuota,navigator.webkitPersistentStorage)(e||104857600)},o.requestTemporaryQuota=function(e){return t.wrapCallbacks(navigator.webkitTemporaryStorage.requestQuota,navigator.webkitTemporaryStorage)(e||104857600)},o.writeFile=function(e,t){var r=n.defer();return e.onwriteend=r.resolve.bind(r),e.onerror=r.reject.bind(r),e.write(t),r.promise},o.isSupported=function(){return!!window.requestFileSystem},o}])},63:function(e,t,n){"use strict";angular.module("w69b.chromeAnalytics",[]).provider("analytics",function(){var e,t;this.setTrackingId=function(t){e=t},this.setApp=function(e,n){t=arguments},this.$get=["$window",function(n){if(!t)throw new Error("make sure to call analyticsProvider.setApp()");if(!n.analytics)throw new Error("chrome-analytics lib not loaded");var r=n.analytics,o=r.getService.apply(r,t),i=o.getTracker(e),a={};return a.tracker=i,a.eventBuilder=function(){return r.EventBuilder.builder()},a.setEnabled=function(e){o.getConfig().addCallback(function(t){t.setTrackingPermitted(e)})},a.send=function(){i.send.apply(i,arguments)},a.trackPageView=function(e){i.sendAppView(e)},a.trackEvent=function(){i.sendEvent.apply(i,arguments)},a.sendNonInteractionEvent=function(e,t,n,o){var i={eventCategory:e,eventAction:t,eventLabel:n,eventValue:o,nonInteraction:!0};a.send(r.HitTypes.EVENT,i)},a.trackTimer=function(e,t,n){var r,o={start:function(){return r=(new Date).getTime(),o},send:function(a,c,u){var s=(new Date).getTime();return i.sendTiming(a||e,c||t,s-r,u||n),o}};return o.start(),o},a}]})},64:function(e,t,n){"use strict";angular.module("w69b.uritool",[]).factory("uritool",function(){var e=/\+/g;function t(t){return decodeURIComponent(t.replace(e," "))}var n={parseQuery:function(e,n){var r;"?"==e[0]&&(e=e.substring(1));for(var o=/([^&=]+)=?([^&]*)/g,i={};r=o.exec(e);){var a=t(r[1]),c=t(r[2]);n&&i.hasOwnProperty(a)?i[a].push(c):i[a]=n?[c]:c}return i},parseUrl:function(e){var t=document.createElement("a");return t.href=e,{protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,hash:t.hash,path:t.pathname}},encodeQuery:function(e){var t=[];return angular.forEach(e,function(e,n){angular.isArray(e)?angular.forEach(e,function(e){t.push(encodeURIComponent(n)+(!0===e?"":"="+encodeURIComponent(e)))}):t.push(encodeURIComponent(n)+(!0===e?"":"="+encodeURIComponent(e)))}),t.length?t.join("&"):""}};return n})},65:function(e,t,n){"use strict";angular.module("w69b.uuid",[]).factory("uuid",["$window",function(e){function t(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t}return function(){var n=new Uint16Array(8);return e.crypto.getRandomValues(n),t(n[0])+t(n[1])+"-"+t(n[2])+"-4"+t(n[3]).substring(1)+"-y"+t(n[4]).substring(1)+"-"+t(n[5])+t(n[6])+t(n[7])}}])},89:function(e,t,n){"use strict";angular.module("castifyExt.connect.appPermissions",["w69b.chromeStorage","w69b.spawn"]).factory("appPermissions",["chromeStorage","spawn",function(e,t){var n="appPermissions",r={};function o(e){var t=Date.now();return e.filter(function(e){return e.timeout>=t})}function i(){return e.local.getSingle(n,[]).then(o)}return r.hasAccess=function(e,t){return i().then(function(n){return n.some(function(n){return n.appId===e&&n.fileId===t})})},r.allowAccess=function(r,o){return t(function*(){var t,a=yield i();(a=a.filter(function(e){return e.appId!==r&&e.appId!==o})).push({appId:r,fileId:o,timeout:Date.now()+18e5}),yield(t=a,e.local.setSingle(n,t))})},r}])}});